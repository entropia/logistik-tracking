<!DOCTYPE html>
<html lang="en">
  <title>htm Demo</title>
  <script type="importmap">
    {
      "imports": {
        "history": "https://esm.sh/history@5.3.0",
        "history/": "https://esm.sh/history@5.3.0/",
        "preact": "https://esm.sh/preact@10.23.1",
        "preact/": "https://esm.sh/preact@10.23.1/",
        "@preact/signals": "https://esm.sh/@preact/signals@1.3.0?external=preact",
        "preact-router": "https://esm.sh/preact-router@4.1.2?external=preact",
        "htm/preact": "https://esm.sh/htm@3.1.1/preact?external=preact"
      }
    }
  </script>
  <script type="module">
    import { html } from 'htm/preact';
    import { Component, render } from 'preact';
    import { Router} from 'preact-router';
    import history from 'history/hash';

    const NotFound = (props) => (
      html`<p>LOLOL</p>`
    )

    const Link = (props) => {
      console.log("I was here", props.href, location)
      return html`<a href=${props.href}>${props.children}</a>`
    }

    const App = (props) => {
      return html`
        <div class="app">
          <${Router} history=${history}>
            <${InnerApp} path="/app" page='app' />
            <${InnerApp} path="/app2" page='app2' />
            <${NotFound} default />
          <//>
          <p><${Link} href="#/app">lol<//> <a href="#/app2" >lol2</a></p>
        </div>`
    }

    class InnerApp extends Component {
      addTodo() {
        const { todos = [] } = this.state;
        this.setState({ todos: todos.concat(`Item ${todos.length}`) });
      }
      render({ page }, { todos = [] }) {
        console.log("page:", page)
        return html`
          <div class="app">
            <${Header} name="ToDo's (${page})" />
            <ul>
              ${todos.map(todo => html`
                <li key=${todo}>${todo}</li>
              `)}
            </ul>
            <button onClick=${() => this.addTodo()}>Add Todo</button>
            <${Footer}>footer content here<//>
          </div>
        `;
      }
    }

    const Header = ({ name }) => html`<h1>${name} List</h1>`

    const Footer = props => html`<footer ...${props} />`

    //render(html`<${App} page="All" />`, document.body);
    render(html`<${App} page="All" />`, document.body);
  </script>
</html>

